<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>5. R 绘图基础 &mdash; R 语言简介  文档</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="_static/style.css" type="text/css" />
    <link rel="canonical" href="https://wklchris.github.io/blog/R/PlottingBasic.html"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="6. ggplot2 绘图" href="PlottingGGplot2.html" />
    <link rel="prev" title="4. 函数操作" href="CreateFunctions.html" />
 

<!-- <link rel="stylesheet" type="text/css" href="_config/static/DataTables/datatables.min.css"/> -->

<meta name="google-site-verification" content="ZsXR1o8suFFOr_MSgo5BTvjbznAuEP6XYOmgMiBu5Yw" />
<script>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-90643174-3']);
  _gaq.push(['_trackPageview']);
</script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

            <a href="index.html" class="icon icon-home"> R 语言简介
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<div class="home-button">
   <a class="home-button" href="https://github.com/wklchris/blog">
      仓库
   </a>&nbsp;&nbsp;|&nbsp;&nbsp;<a class="home-button" href="/blog/">
      博客主页
   </a>&nbsp;&nbsp;|&nbsp;&nbsp;<a class="home-button" href="/">
      关于我
   </a>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">目录</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="DataStructure.html">1. 数据结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="ReadData.html">2. 数据读取</a></li>
<li class="toctree-l1"><a class="reference internal" href="ManageData.html">3. 数据管理</a></li>
<li class="toctree-l1"><a class="reference internal" href="CreateFunctions.html">4. 函数操作</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. R 绘图基础</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#基础命令">5.1. 基础命令</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#plot()-绘图类型">5.1.1. plot() 绘图类型</a></li>
<li class="toctree-l3"><a class="reference internal" href="#输出到文件">5.1.2. 输出到文件</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#绘图参数：par()">5.2. 绘图参数：par()</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#点样式、线宽与线型">5.2.1. 点样式、线宽与线型</a></li>
<li class="toctree-l3"><a class="reference internal" href="#颜色">5.2.2. 颜色</a></li>
<li class="toctree-l3"><a class="reference internal" href="#标签和标题文本">5.2.3. 标签和标题文本</a></li>
<li class="toctree-l3"><a class="reference internal" href="#图形尺寸与边距">5.2.4. 图形尺寸与边距</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#自定义其他元素">5.3. 自定义其他元素</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#坐标轴">5.3.1. 坐标轴</a></li>
<li class="toctree-l3"><a class="reference internal" href="#网格线：abline()-与次要刻度">5.3.2. 网格线：abline() 与次要刻度</a></li>
<li class="toctree-l3"><a class="reference internal" href="#图例">5.3.3. 图例</a></li>
<li class="toctree-l3"><a class="reference internal" href="#标注">5.3.4. 标注</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#文字标注">5.3.4.1. 文字标注</a></li>
<li class="toctree-l4"><a class="reference internal" href="#数学标注">5.3.4.2. 数学标注</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#叠加绘图">5.3.5. 叠加绘图</a></li>
<li class="toctree-l3"><a class="reference internal" href="#子图">5.3.6. 子图</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#函数-layout()">5.3.6.1. 函数 layout()</a></li>
<li class="toctree-l4"><a class="reference internal" href="#函数-par()-的-mfrow-参数">5.3.6.2. 函数 par() 的 mfrow 参数</a></li>
<li class="toctree-l4"><a class="reference internal" href="#函数-par()-的-fig-参数">5.3.6.3. 函数 par() 的 fig 参数</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#统计图">5.4. 统计图</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#条形图：barplot()">5.4.1. 条形图：barplot()</a></li>
<li class="toctree-l3"><a class="reference internal" href="#饼图：pie()">5.4.2. 饼图：pie()</a></li>
<li class="toctree-l3"><a class="reference internal" href="#直方图：hist()-及核密度曲线">5.4.3. 直方图：hist() 及核密度曲线</a></li>
<li class="toctree-l3"><a class="reference internal" href="#箱形图：boxplot()-及小提琴图">5.4.4. 箱形图：boxplot() 及小提琴图</a></li>
<li class="toctree-l3"><a class="reference internal" href="#点图">5.4.5. 点图</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PlottingGGplot2.html">6. ggplot2 绘图</a></li>
<li class="toctree-l1"><a class="reference internal" href="DescriptiveStatistics.html">7. R中的描述性统计</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">R 语言简介</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li><span class="section-number">5. </span>R 绘图基础</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/PlottingBasic.ipynb.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="R-绘图基础">
<h1><span class="section-number">5. </span>R 绘图基础<a class="headerlink" href="#R-绘图基础" title="永久链接至标题"></a></h1>
<p>R 的绘图功能一直为业内所津津乐道。</p>
<p>p.s. <em>用了 Python 的 matplotlib 和 R 的 ggplot2 后，再也不想用 MATLAB 画图了……</em></p>
<p>我现在这里先给出本博文用到的包：</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">library</span><span class="p">(</span><span class="n">Hmisc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Loading required package: lattice
Loading required package: survival
Loading required package: Formula
Loading required package: ggplot2

Attaching package: &#39;Hmisc&#39;

The following objects are masked from &#39;package:base&#39;:

    format.pval, round.POSIXt, trunc.POSIXt, units

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">library</span><span class="p">(</span><span class="n">vioplot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Loading required package: sm
Package &#39;sm&#39;, version 2.2-5.4: type help(sm) for summary information
</pre></div></div>
</div>
<section id="基础命令">
<h2><span class="section-number">5.1. </span>基础命令<a class="headerlink" href="#基础命令" title="永久链接至标题"></a></h2>
<p>使用 <code class="docutils literal notranslate"><span class="pre">dev.new()</span></code> 命令新建一个图片视图，这样你可以输出多个图片到屏幕，而不是让之后输出的覆盖之前的图形。关于 dev.next(), dev.prev(), dev.set() 及 dev.off() 等内容，参考 help(dev.cur).</p>
<section id="plot()-绘图类型">
<h3><span class="section-number">5.1.1. </span>plot() 绘图类型<a class="headerlink" href="#plot()-绘图类型" title="永久链接至标题"></a></h3>
<p>基本的绘图类型有以下几种，使用 type= 参数指定：</p>
<ul class="simple">
<li><p>p：仅数据点，默认值。</p></li>
<li><p>l：仅线段</p></li>
<li><p>b：线段与点</p></li>
<li><p>c：仅线段，但点的位置留出空白</p></li>
<li><p>o：线段与点，但线段会延伸到点内部</p></li>
<li><p>h：直方图风格，即带竖直密度线</p></li>
<li><p>s：阶梯图</p></li>
<li><p>S：其他特殊情况</p></li>
<li><p>n；不绘制图形。用于指定标题、坐标轴名称的情况</p></li>
</ul>
</section>
<section id="输出到文件">
<h3><span class="section-number">5.1.2. </span>输出到文件<a class="headerlink" href="#输出到文件" title="永久链接至标题"></a></h3>
<p>将画图的内容输出到文件，可以指定路径，不指定就输出到当前工作目录。例如输出 pdf：</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">pdf</span><span class="p">(</span><span class="s">&quot;plot.pdf&quot;</span><span class="p">)</span>
  <span class="nf">plot</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">),</span> <span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
<span class="nf">dev.off</span><span class="p">()</span>
</pre></div>
</div>
<p>除了 pdf() 外，其他可用的输出格式对应函数：</p>
<ul class="simple">
<li><p><strong>wmf</strong>：win.metafile()，仅在 Windows 系统下使用</p></li>
<li><p><strong>png</strong>: png()</p></li>
<li><p><strong>jpeg</strong>: jpeg()</p></li>
<li><p><strong>bmp</strong>: bmp()</p></li>
<li><p><strong>tiff</strong>: tiff()</p></li>
<li><p><strong>ps</strong>: postscript()</p></li>
</ul>
<p>例子。详细的参数在下文讨论。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">x</span> <span class="o">&lt;-</span> <span class="m">1</span><span class="o">:</span><span class="m">4</span>
<span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;b&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PlottingBasic_5_0.png" src="_images/PlottingBasic_5_0.png" />
</div>
</div>
</section>
</section>
<section id="绘图参数：par()">
<h2><span class="section-number">5.2. </span>绘图参数：par()<a class="headerlink" href="#绘图参数：par()" title="永久链接至标题"></a></h2>
<p>函数 par() 用来获取<strong>当前图形</strong>的参数。如果加入 no.readonly=TRUE, 表示该参数列表是非只读的，即用户可以进行修改。例如对于上图，我们获取其参数，进行更改后再传到新的图中（pch 参数可能有些费解，我们在下文讨论）：</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># 方法一：类交互式的更改方法</span>
<span class="n">opar</span> <span class="o">&lt;-</span> <span class="nf">par</span><span class="p">(</span><span class="n">no.readonly</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">pch</span><span class="o">=</span><span class="m">17</span><span class="p">)</span>  <span class="c1"># 更改点样式</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;b&quot;</span><span class="p">)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">opar</span><span class="p">)</span>

<span class="c1"># 方法二：部分绘图参数支持直接传入参数</span>
<span class="c1"># plot(x, y, type=&quot;b&quot;, pch=17)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PlottingBasic_7_0.png" src="_images/PlottingBasic_7_0.png" />
</div>
</div>
<section id="点样式、线宽与线型">
<h3><span class="section-number">5.2.1. </span>点样式、线宽与线型<a class="headerlink" href="#点样式、线宽与线型" title="永久链接至标题"></a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>参数</p></th>
<th class="head"><p>可选值</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>pch 点样式</p></td>
<td><p>0空方块，1空圆，
2空三角，3加号，4乘号，5斜空方块，6空倒三角，7叉方块，8星号，9斜叉方块，10圈加号，11六芒星，12田，13圈乘号，14加框尖角，15方块，16圆点，17三角，18斜方块，19带边线圆点，20带边线2/3圆点，21填充圆，22填充方块，23填充斜方块，24填充三角，25填充倒三角。</p></td>
</tr>
<tr class="row-odd"><td><p>cex 点大小</p></td>
<td><p>数字，例如 0.5。</p></td>
</tr>
<tr class="row-even"><td><p>lty 线型</p></td>
<td><p>1实线，2短虚线，3点线，4点划线，5长虚线，6长短划线。</p></td>
</tr>
<tr class="row-odd"><td><p>lwd 线宽</p></td>
<td><p>数字。</p></td>
</tr>
</tbody>
</table>
<p><em>注: pch = 19 相比 pch = 16，主要体现在 lwd 与 cex 不同时，带边线圆点的尺寸较大。</em></p>
</section>
<section id="颜色">
<h3><span class="section-number">5.2.2. </span>颜色<a class="headerlink" href="#颜色" title="永久链接至标题"></a></h3>
<p>调整颜色的参数有：</p>
<ul class="simple">
<li><p>col: 绘图颜色。</p></li>
<li><p>col.axis：坐标轴刻度颜色。</p></li>
<li><p>col.lab：坐标轴名称颜色。</p></li>
<li><p>col.main：图形标题颜色。</p></li>
<li><p>col.sub：副标题颜色。</p></li>
<li><p>fg：图形前景色。</p></li>
<li><p>bf：图形背景色。</p></li>
</ul>
<p>指定颜色的方式有如下几种：</p>
<ul class="simple">
<li><p>数字下标：col=1</p></li>
<li><p>名称：col=“white”</p></li>
<li><p>十六进制值：col=“#FFFFFF”</p></li>
<li><p>标准化RGB/HSV值：col=rgb(0,1,1)/hsv(0,0,1)</p></li>
</ul>
<p>至于 R 支持的颜色名称，多达 600 余种，这里给出一些我认为常见的：</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">OutputColors</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">color.names</span><span class="p">,</span> <span class="n">titleStr</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">showText</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">plot</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="bp">F</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">6</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">6</span><span class="p">),</span> <span class="n">main</span><span class="o">=</span><span class="n">titleStr</span><span class="p">,</span> <span class="n">xlab</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ylab</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
    <span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">))</span> <span class="p">{</span>
        <span class="nf">for </span><span class="p">(</span><span class="n">j</span> <span class="n">in</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">))</span> <span class="p">{</span>
            <span class="nf">par</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>
            <span class="nf">plot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="m">6</span><span class="o">-</span><span class="n">j</span><span class="p">,</span> <span class="n">cex</span><span class="o">=</span><span class="m">3</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">6</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">6</span><span class="p">),</span> <span class="n">axes</span><span class="o">=</span><span class="bp">F</span><span class="p">,</span>
                 <span class="n">main</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">xlab</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ylab</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">pch</span><span class="o">=</span><span class="m">19</span><span class="p">,</span>
                 <span class="n">col</span><span class="o">=</span><span class="n">color.names</span><span class="p">[(</span><span class="n">i</span><span class="m">-1</span><span class="p">)</span><span class="o">*</span><span class="m">5</span><span class="o">+</span><span class="n">j</span><span class="p">])</span>
            <span class="nf">if </span><span class="p">(</span><span class="n">showText</span><span class="p">)</span> <span class="p">{</span>
                <span class="nf">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="m">6</span><span class="o">-</span><span class="n">j</span><span class="m">-0.1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">color.names</span><span class="p">[(</span><span class="n">i</span><span class="m">-1</span><span class="p">)</span><span class="o">*</span><span class="m">5</span><span class="o">+</span><span class="n">j</span><span class="p">])</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">colorLst</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;white&quot;</span><span class="p">,</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="s">&quot;green&quot;</span><span class="p">,</span> <span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="s">&quot;brown&quot;</span><span class="p">,</span>
              <span class="s">&quot;cyan&quot;</span><span class="p">,</span> <span class="s">&quot;gold&quot;</span><span class="p">,</span> <span class="s">&quot;gray&quot;</span><span class="p">,</span> <span class="s">&quot;plum&quot;</span><span class="p">,</span> <span class="s">&quot;magenta&quot;</span><span class="p">,</span>
              <span class="s">&quot;orange&quot;</span><span class="p">,</span> <span class="s">&quot;purple&quot;</span><span class="p">,</span> <span class="s">&quot;yellow&quot;</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="s">&quot;violet&quot;</span><span class="p">,</span>
              <span class="s">&quot;darkblue&quot;</span><span class="p">,</span> <span class="s">&quot;darkgreen&quot;</span><span class="p">,</span> <span class="s">&quot;darkred&quot;</span><span class="p">,</span> <span class="s">&quot;darkgray&quot;</span><span class="p">,</span> <span class="s">&quot;dimgray&quot;</span><span class="p">,</span>
              <span class="s">&quot;lightblue&quot;</span><span class="p">,</span> <span class="s">&quot;lightgreen&quot;</span><span class="p">,</span> <span class="s">&quot;lightgray&quot;</span><span class="p">,</span> <span class="s">&quot;orchid&quot;</span><span class="p">,</span> <span class="s">&quot;pink&quot;</span><span class="p">)</span>
<span class="nf">OutputColors</span><span class="p">(</span><span class="n">colorLst</span><span class="p">,</span> <span class="s">&quot;25 Useful Colors&quot;</span><span class="p">,</span> <span class="bp">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PlottingBasic_9_0.png" src="_images/PlottingBasic_9_0.png" />
</div>
</div>
<p>R 中还有其他方式可以生成一系列的颜色，比如：</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span> <span class="p">,</span><span class="m">3</span><span class="p">))</span>
<span class="nf">OutputColors</span><span class="p">(</span><span class="nf">rainbow</span><span class="p">(</span><span class="m">25</span><span class="p">),</span> <span class="s">&quot;Rainbow&quot;</span><span class="p">)</span>
<span class="nf">OutputColors</span><span class="p">(</span><span class="nf">heat.colors</span><span class="p">(</span><span class="m">25</span><span class="p">),</span> <span class="s">&quot;HeatMap&quot;</span><span class="p">)</span>
<span class="nf">OutputColors</span><span class="p">(</span><span class="nf">terrain.colors</span><span class="p">(</span><span class="m">25</span><span class="p">),</span> <span class="s">&quot;TerrainMap&quot;</span><span class="p">)</span>
<span class="nf">OutputColors</span><span class="p">(</span><span class="nf">topo.colors</span><span class="p">(</span><span class="m">25</span><span class="p">),</span> <span class="s">&quot;Topo&quot;</span><span class="p">)</span>
<span class="nf">OutputColors</span><span class="p">(</span><span class="nf">cm.colors</span><span class="p">(</span><span class="m">25</span><span class="p">),</span> <span class="s">&quot;CM&quot;</span><span class="p">)</span>
<span class="c1"># 灰度：需要标准化</span>
<span class="nf">OutputColors</span><span class="p">(</span><span class="nf">gray</span><span class="p">(</span><span class="m">1</span><span class="o">/</span><span class="m">25</span><span class="o">*</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="o">:</span><span class="m">25</span><span class="p">)),</span> <span class="s">&quot;Gray&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PlottingBasic_11_0.png" src="_images/PlottingBasic_11_0.png" />
</div>
</div>
</section>
<section id="标签和标题文本">
<h3><span class="section-number">5.2.3. </span>标签和标题文本<a class="headerlink" href="#标签和标题文本" title="永久链接至标题"></a></h3>
<p>从上文可以看出端倪，标签与标题参数有：</p>
<ul class="simple">
<li><p><strong>标题/副标题</strong>：title/sub</p></li>
<li><p><strong>坐标轴标题</strong>：xlab/ylab</p></li>
</ul>
<p>在标题中使用上文介绍的参数：</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">title</span><span class="p">(</span><span class="n">main</span><span class="o">=</span><span class="s">&quot;My Title&quot;</span><span class="p">,</span> <span class="n">col.main</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span>
    <span class="n">sub</span><span class="o">=</span><span class="s">&quot;My Subtitle&quot;</span><span class="p">,</span> <span class="n">col.sub</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span>
    <span class="n">xlab</span><span class="o">=</span><span class="s">&quot;My X label&quot;</span><span class="p">,</span> <span class="n">ylab</span><span class="o">=</span><span class="s">&quot;My Y label&quot;</span><span class="p">,</span>
    <span class="n">col.lab</span><span class="o">=</span><span class="s">&quot;green&quot;</span><span class="p">,</span> <span class="n">cex.lab</span><span class="o">=</span><span class="m">0.75</span><span class="p">)</span>
</pre></div>
</div>
<p>要定义它们的字体，可添加的参数有：</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 73%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>参数</p></th>
<th class="head"><p>含义</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>cex</p></td>
<td><p>基础缩放倍数</p></td>
</tr>
<tr class="row-odd"><td><p>cex.axis</p></td>
<td><p>坐标轴刻度的缩放倍数</p></td>
</tr>
<tr class="row-even"><td><p>cex.lab</p></td>
<td><p>坐标轴标题的缩放倍数</p></td>
</tr>
<tr class="row-odd"><td><p>cex.main</p></td>
<td><p>图形标题的缩放倍数</p></td>
</tr>
<tr class="row-even"><td><p>cex.sub</p></td>
<td><p>图形副标题的缩放倍数</p></td>
</tr>
<tr class="row-odd"><td><p>font</p></td>
<td><p>字体样式。1常规，2加粗，3加斜，4加粗加斜，5符号字体</p></td>
</tr>
<tr class="row-even"><td><p>font.axis</p></td>
<td><p>坐标轴刻度的字体样式</p></td>
</tr>
<tr class="row-odd"><td><p>font.lab/ main/ sub</p></td>
<td><p>类推</p></td>
</tr>
<tr class="row-even"><td><p>ps</p></td>
<td><p>字体磅值。文字的最终大小为 cex * ps</p></td>
</tr>
<tr class="row-odd"><td><p>family</p></td>
<td><p>字族。例如 serif衬线, sans无衬线, mono等宽</p></td>
</tr>
</tbody>
</table>
<p>字族的使用需要注意：Windows 中，等宽映射为 Courier New，衬线 Times New Roman，无衬线 Arial。你可以使用 windowsFonts() 函数来更改或者创建映射，例如我个人常用的 DejaVu 等宽字体：</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">windowsFonts</span><span class="p">(</span>
    <span class="n">M</span><span class="o">=</span><span class="nf">windowsFont</span><span class="p">(</span><span class="s">&quot;DejaVu Sans Mono&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;n&quot;</span><span class="p">)</span>
<span class="c1"># 字体示例</span>
<span class="nf">text</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1.05</span><span class="p">,</span> <span class="nf">paste</span><span class="p">(</span><span class="s">&quot;DejaVu Sans Mono\n&quot;</span><span class="p">,</span>
                    <span class="s">&quot;0123456789!@#$%^&amp;*()[]{}:;,.&lt;&gt;&#39;/?`~&quot;</span><span class="p">,</span>
                    <span class="s">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span><span class="p">,</span>
                    <span class="s">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span><span class="p">,</span>
                    <span class="n">sep</span><span class="o">=</span><span class="s">&quot;\n&quot;</span><span class="p">),</span> <span class="n">pos</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s">&quot;M&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PlottingBasic_13_0.png" src="_images/PlottingBasic_13_0.png" />
</div>
</div>
<p>如果你需要将图片输出到 pdf，这个参数也是可以使用的：</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s">&quot;filename.pdf&quot;</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s">&quot;M&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="图形尺寸与边距">
<h3><span class="section-number">5.2.4. </span>图形尺寸与边距<a class="headerlink" href="#图形尺寸与边距" title="永久链接至标题"></a></h3>
<p>参数 pin 用于指定图形尺寸（英寸），例如 <code class="docutils literal notranslate"><span class="pre">pin=c(4,</span> <span class="pre">3)</span></code> 表示 4 英寸宽 3 英寸高。</p>
<p>用 mai()/mar() 依次指定下左上右四个方向的边距，单位分别是英寸与英分。默认是 <code class="docutils literal notranslate"><span class="pre">mar(c(5,</span> <span class="pre">4,</span> <span class="pre">4,</span> <span class="pre">2))</span> <span class="pre">+</span> <span class="pre">0.1</span></code></p>
</section>
</section>
<section id="自定义其他元素">
<h2><span class="section-number">5.3. </span>自定义其他元素<a class="headerlink" href="#自定义其他元素" title="永久链接至标题"></a></h2>
<section id="坐标轴">
<h3><span class="section-number">5.3.1. </span>坐标轴<a class="headerlink" href="#坐标轴" title="永久链接至标题"></a></h3>
<p>函数 side() 用于自定义坐标轴：</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">axis</span><span class="p">(</span><span class="n">side</span><span class="p">,</span> <span class="n">at</span><span class="o">=</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">,</span> <span class="n">lty</span><span class="o">=</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="p">,</span> <span class="n">las</span><span class="o">=</span><span class="p">,</span> <span class="n">tck</span><span class="o">=</span><span class="p">,</span> <span class="kc">...</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>side: 指定在哪绘制坐标轴：1下2左3上4右</p></li>
<li><p>at：刻度线位置</p></li>
<li><p>labels：刻度线旁的标签，缺省时使用 at 中的值</p></li>
<li><p>pos：坐标轴与另一坐标轴相交位置的值</p></li>
<li><p>lty/col：线型/线与刻度的颜色</p></li>
<li><p>las：标签平行于（=0）或垂直于（=2）坐标轴</p></li>
<li><p>tck：刻度线。负值表示在图形外侧，0表示禁用刻度，1表示全长（即网格线）；默认 -0.01</p></li>
</ul>
</section>
<section id="网格线：abline()-与次要刻度">
<h3><span class="section-number">5.3.2. </span>网格线：abline() 与次要刻度<a class="headerlink" href="#网格线：abline()-与次要刻度" title="永久链接至标题"></a></h3>
<p>如果想使用次要刻度，请安装 Hmisc 包。次要刻度的长度将会是主刻度的 <code class="docutils literal notranslate"><span class="pre">tick.ratio</span></code> 倍。</p>
<p>网格线使用 abline() 命令，并分别用 h/v 指定网格线是竖直还是水平。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># 需要加载：library(Hmisc)</span>
<span class="nf">plot</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">4</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">4</span><span class="p">))</span>
<span class="nf">minor.tick</span><span class="p">(</span><span class="n">nx</span><span class="o">=</span><span class="m">2</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="m">4</span><span class="p">,</span> <span class="n">tick.ratio</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">0.5</span><span class="p">),</span> <span class="n">h</span><span class="o">=</span><span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">0.25</span><span class="p">),</span> <span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&quot;darkred&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PlottingBasic_16_0.png" src="_images/PlottingBasic_16_0.png" />
</div>
</div>
</section>
<section id="图例">
<h3><span class="section-number">5.3.3. </span>图例<a class="headerlink" href="#图例" title="永久链接至标题"></a></h3>
<p>命令 legend() 用于添加图例。</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">legend</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">legend</span><span class="p">,</span> <span class="p">[</span><span class="n">title</span><span class="o">=</span><span class="p">,</span> <span class="kc">...</span><span class="p">])</span>
</pre></div>
</div>
<p>参数含义：</p>
<ul class="simple">
<li><p>location：指定图例左上角的坐标，或者使用以下关键字：</p>
<ul>
<li><p>关键字：left/right, bottom/top, bottomleft/right, topleft/right, center</p></li>
<li><p>如果使用了以上关键字，可以使用 inset= 参数指定向图形内移动的比例（分数形式）</p></li>
</ul>
</li>
<li><p>legend：标签组成的字符型向量。</p></li>
<li><p>title：图例标题的字符串</p></li>
<li><p>其他参数：</p>
<ul>
<li><p>col/pch/lwd/lty：图例线条颜色/点样式/线宽/线型</p></li>
<li><p>bty/fill：盒型样式/颜色填充（用于条形图、箱形图或饼图）</p></li>
<li><p>bg：背景色</p></li>
<li><p>text.col：文本颜色</p></li>
<li><p>horiz：TRUE 会将图例水平放置</p></li>
</ul>
</li>
</ul>
<p>例子参见“直方图”一节的最后一例。</p>
</section>
<section id="标注">
<h3><span class="section-number">5.3.4. </span>标注<a class="headerlink" href="#标注" title="永久链接至标题"></a></h3>
<section id="文字标注">
<h4><span class="section-number">5.3.4.1. </span>文字标注<a class="headerlink" href="#文字标注" title="永久链接至标题"></a></h4>
<p>主要有两个函数：text() 与 mtext()。前者向绘图区添加标注，后者向图形的边界添加标注。</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">text</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="s">&quot;string&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="kc">...</span><span class="p">)</span>
<span class="nf">mtext</span><span class="p">(</span><span class="s">&quot;string&quot;</span><span class="p">,</span> <span class="n">side</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="kc">...</span><span class="p">)</span>
</pre></div>
</div>
<p>可以参考“标签和标题文本”一节的例子。其中：</p>
<ul class="simple">
<li><p>pos：使用1下2左3上4右的对应关系，比如“颜色”一节中就使用了 pos=1 的参数。</p>
<ul>
<li><p>如果指定了 pos，那么也可以指定 offset= 作为偏移量比值（相对单个字符宽）</p></li>
</ul>
</li>
<li><p>side：指定放置文本的图片边界，同样是1下2左3上4右。</p>
<ul>
<li><p>你可以使用 line= 来移动文本（正值向外，负值向内）；</p></li>
<li><p>还可以通过 adj=0/1 指定文本向左下/右上对齐。</p></li>
</ul>
</li>
</ul>
</section>
<section id="数学标注">
<h4><span class="section-number">5.3.4.2. </span>数学标注<a class="headerlink" href="#数学标注" title="永久链接至标题"></a></h4>
<p>类似 LaTeX 的标注方式，不过实质上仍有一些区别：</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 23%" />
<col style="width: 13%" />
<col style="width: 24%" />
<col style="width: 8%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>代码</p></th>
<th class="head"><p>效果</p></th>
<th class="head"><p>代码</p></th>
<th class="head"><p>效果</p></th>
<th class="head"><p>代码</p></th>
<th class="head"><p>效果</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x%+-%y</p></td>
<td><p><span class="math notranslate nohighlight">\(x\pm y\)</span></p></td>
<td><p>x%/%y</p></td>
<td><p><span class="math notranslate nohighlight">\(x\div y\)</span></p></td>
<td><p>x%*%y</p></td>
<td><p><span class="math notranslate nohighlight">\(x\times y\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>x%.%y</p></td>
<td><p><span class="math notranslate nohighlight">\(x\cdot y\)</span></p></td>
<td><p>x[i]</p></td>
<td><p><span class="math notranslate nohighlight">\(x_i\)</span></p></td>
<td><p>x^2</p></td>
<td><p><span class="math notranslate nohighlight">\(x^2\)</span></p></td>
</tr>
<tr class="row-even"><td><p>x%prop%y</p></td>
<td><p><span class="math notranslate nohighlight">\(x\propto y\)</span></p></td>
<td><p>sqrt(x, y)</p></td>
<td><p><span class="math notranslate nohighlight">\(\sqrt[y]{x}\)</span></p></td>
<td><p>x!=y</p></td>
<td><p><span class="math notranslate nohighlight">\(x\neq y\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>x%~~%y</p></td>
<td><p><span class="math notranslate nohighlight">\(x\approx y\)</span></p></td>
<td><p>x%=~%y</p></td>
<td><p><span class="math notranslate nohighlight">\(x\cong y\)</span></p></td>
<td><p>x%==%y</p></td>
<td><p><span class="math notranslate nohighlight">\(x\equiv y\)</span></p></td>
</tr>
</tbody>
</table>
<p>部分字体相关的命令：</p>
<ul class="simple">
<li><p>plain(x)：正体</p></li>
<li><p>italic(x)：意大利字族（加斜）</p></li>
<li><p>bold(x)：加粗</p></li>
<li><p>bolditalic(x)：加斜加粗</p></li>
<li><p>underline(x)：下划线</p></li>
</ul>
</section>
</section>
<section id="叠加绘图">
<h3><span class="section-number">5.3.5. </span>叠加绘图<a class="headerlink" href="#叠加绘图" title="永久链接至标题"></a></h3>
<p>叠加绘图最简单的方法，就是使用绘图的 <code class="docutils literal notranslate"><span class="pre">new=TRUE</span></code>：</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span> <span class="kc">...</span> <span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span> <span class="kc">...</span> <span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>  <span class="c1"># 记得用 axes=FALSE 将坐标轴、标签、标题隐藏掉</span>
</pre></div>
</div>
<p>如果想要添加额外的点、线，使用 <code class="docutils literal notranslate"><span class="pre">points()</span></code> 命令与 <code class="docutils literal notranslate"><span class="pre">lines()</span></code> 命令。以及上面提到的参考线 <code class="docutils literal notranslate"><span class="pre">abline()</span></code> 命令：</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">plot</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">),</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="n">pch</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>

<span class="nf">points</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1.5</span><span class="p">,</span> <span class="m">2.5</span><span class="p">,</span> <span class="m">0.5</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="n">pch</span><span class="o">=</span><span class="m">16</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1.5</span><span class="p">,</span> <span class="m">2.5</span><span class="p">,</span> <span class="m">0.5</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="m">1.5</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="m">2.25</span><span class="p">,</span> <span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&quot;purple&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PlottingBasic_19_0.png" src="_images/PlottingBasic_19_0.png" />
</div>
</div>
</section>
<section id="子图">
<h3><span class="section-number">5.3.6. </span>子图<a class="headerlink" href="#子图" title="永久链接至标题"></a></h3>
<section id="函数-layout()">
<h4><span class="section-number">5.3.6.1. </span>函数 layout()<a class="headerlink" href="#函数-layout()" title="永久链接至标题"></a></h4>
<p>函数 layout() 是一个强大的命令。例如：</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">layout</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">),</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="n">byrow</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">))</span>
</pre></div>
</div>
<p>就指定了图 1 占用第一行，图 2 和 3 共用第二行。也可以用 widths=/heights= 参数指定各列宽/各行高之间的比例：</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">tmp</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="s">&quot;Cat&quot;</span><span class="p">,</span> <span class="m">3</span><span class="p">),</span> <span class="nf">rep</span><span class="p">(</span><span class="s">&quot;Dog&quot;</span><span class="p">,</span> <span class="m">4</span><span class="p">),</span> <span class="nf">rep</span><span class="p">(</span><span class="s">&quot;Rabbit&quot;</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
<span class="n">dt</span> <span class="o">&lt;-</span> <span class="nf">table</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

<span class="nf">layout</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">),</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="n">byrow</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span>
       <span class="n">widths</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> <span class="n">heights</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
<span class="nf">barplot</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
<span class="nf">barplot</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
<span class="nf">barplot</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PlottingBasic_21_0.png" src="_images/PlottingBasic_21_0.png" />
</div>
</div>
</section>
<section id="函数-par()-的-mfrow-参数">
<h4><span class="section-number">5.3.6.2. </span>函数 par() 的 mfrow 参数<a class="headerlink" href="#函数-par()-的-mfrow-参数" title="永久链接至标题"></a></h4>
<p>前文介绍过的 par() 中的 mfrow= 参数也是一个控制子图的方式。下例是两行两列的子图：</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">opar</span> <span class="o">&lt;-</span> <span class="nf">par</span><span class="p">(</span><span class="n">no.readonly</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="kc">...</span><span class="p">)</span>  <span class="c1"># 图 1，左上</span>
<span class="nf">plot</span><span class="p">(</span><span class="kc">...</span><span class="p">)</span>  <span class="c1"># 图 2，右上</span>
<span class="nf">plot</span><span class="p">(</span><span class="kc">...</span><span class="p">)</span>  <span class="c1"># 图 3，左下</span>
<span class="nf">plot</span><span class="p">(</span><span class="kc">...</span><span class="p">)</span>  <span class="c1"># 图 4，右下</span>
<span class="nf">par</span><span class="p">(</span><span class="n">opar</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="函数-par()-的-fig-参数">
<h4><span class="section-number">5.3.6.3. </span>函数 par() 的 fig 参数<a class="headerlink" href="#函数-par()-的-fig-参数" title="永久链接至标题"></a></h4>
<p>这种方式支持你以任何的位置、组合任意的图形。它比规整的 layout() 更加灵活。以下不使用 0.8 而使用 0.65 是为了看上去更紧凑。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">opar</span> <span class="o">&lt;-</span> <span class="nf">par</span><span class="p">(</span><span class="n">no.readonly</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="nf">par</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0.8</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0.8</span><span class="p">))</span>  <span class="c1"># 主图：横向范围与纵向范围（左下为原点）</span>
<span class="nf">barplot</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>


<span class="nf">par</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0.8</span><span class="p">,</span> <span class="m">0.65</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> <span class="n">new</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>  <span class="c1"># 上方的图。注意 new 参数</span>
<span class="nf">barplot</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>

<span class="nf">par</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.65</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0.8</span><span class="p">),</span> <span class="n">new</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>  <span class="c1"># 右侧的图</span>
<span class="nf">barplot</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="bp">F</span><span class="p">,</span> <span class="n">names.arg</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PlottingBasic_23_0.png" src="_images/PlottingBasic_23_0.png" />
</div>
</div>
</section>
</section>
</section>
<section id="统计图">
<h2><span class="section-number">5.4. </span>统计图<a class="headerlink" href="#统计图" title="永久链接至标题"></a></h2>
<section id="条形图：barplot()">
<h3><span class="section-number">5.4.1. </span>条形图：barplot()<a class="headerlink" href="#条形图：barplot()" title="永久链接至标题"></a></h3>
<p>直接上例子。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">tmp</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="s">&quot;Cat&quot;</span><span class="p">,</span> <span class="m">3</span><span class="p">),</span> <span class="nf">rep</span><span class="p">(</span><span class="s">&quot;Dog&quot;</span><span class="p">,</span> <span class="m">4</span><span class="p">),</span> <span class="nf">rep</span><span class="p">(</span><span class="s">&quot;Rabbit&quot;</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
<span class="n">dt</span> <span class="o">&lt;-</span> <span class="nf">table</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

<span class="nf">barplot</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">main</span><span class="o">=</span><span class="s">&quot;Title of Barplot&quot;</span><span class="p">,</span> <span class="n">xlab</span><span class="o">=</span><span class="s">&quot;Pets&quot;</span><span class="p">,</span> <span class="n">ylab</span><span class="o">=</span><span class="s">&quot;Number&quot;</span><span class="p">,</span>
        <span class="n">col</span><span class="o">=</span><span class="s">&quot;green&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span> <span class="m">15</span><span class="p">,</span> <span class="m">25</span><span class="p">),</span>
        <span class="n">names.arg</span><span class="o">=</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Pet&quot;</span><span class="p">,</span> <span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot; &quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PlottingBasic_25_0.png" src="_images/PlottingBasic_25_0.png" />
</div>
</div>
</section>
<section id="饼图：pie()">
<h3><span class="section-number">5.4.2. </span>饼图：pie()<a class="headerlink" href="#饼图：pie()" title="永久链接至标题"></a></h3>
<p>并不推荐的统计图类型，因此 R 中的功能也很有限。</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">pie</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">,</span> <span class="kc">...</span><span class="p">)</span>
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">dt</span> <span class="o">&lt;-</span> <span class="m">1</span><span class="o">:</span><span class="m">4</span>
<span class="n">lbl</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span> <span class="s">&quot;B&quot;</span><span class="p">,</span> <span class="s">&quot;C&quot;</span><span class="p">,</span> <span class="s">&quot;D&quot;</span><span class="p">)</span>
<span class="nf">pie</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="nf">paste</span><span class="p">(</span><span class="n">lbl</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">,</span> <span class="nf">round</span><span class="p">(</span><span class="n">dt</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span><span class="o">*</span><span class="m">100</span><span class="p">),</span> <span class="s">&quot;%&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">),</span>
    <span class="n">col</span><span class="o">=</span><span class="nf">topo.colors</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">lbl</span><span class="p">)),</span> <span class="n">main</span><span class="o">=</span><span class="s">&quot;Pie Chart with Percentage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PlottingBasic_27_0.png" src="_images/PlottingBasic_27_0.png" />
</div>
</div>
</section>
<section id="直方图：hist()-及核密度曲线">
<h3><span class="section-number">5.4.3. </span>直方图：hist() 及核密度曲线<a class="headerlink" href="#直方图：hist()-及核密度曲线" title="永久链接至标题"></a></h3>
<p>直方图表示的是一维的数据（连续型）特征，纵轴是其在对应横轴区间内的频数或者频率。</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> <span class="n">breaks</span><span class="o">=</span><span class="p">,</span> <span class="kc">...</span><span class="p">)</span>
</pre></div>
</div>
<p>其中 freq 参数默认指定纵轴为频数而不是频率，break 用于指定横轴上分组的个数。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="m">100</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="m">0</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>

<span class="c1"># 左图：频率直方图，以及轴须图</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="bp">F</span><span class="p">,</span> <span class="n">breaks</span><span class="o">=</span><span class="m">10</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&quot;cyan&quot;</span><span class="p">,</span> <span class="n">main</span><span class="o">=</span><span class="s">&quot;Hist fig 1&quot;</span><span class="p">)</span>
<span class="nf">rug</span><span class="p">(</span><span class="nf">jitter</span><span class="p">(</span><span class="n">dt</span><span class="p">))</span>  <span class="c1"># 如果有许多相同值，参数 amount=0.01 可将其随机化</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">density</span><span class="p">(</span><span class="n">dt</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&quot;purple&quot;</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>

<span class="c1"># 右图：频数直方图，以及正态密度曲线</span>
<span class="n">h.plot</span> <span class="o">&lt;-</span> <span class="nf">hist</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">breaks</span><span class="o">=</span><span class="m">10</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&quot;lightgreen&quot;</span><span class="p">,</span> <span class="n">main</span><span class="o">=</span><span class="s">&quot;Hist fig 2&quot;</span><span class="p">)</span>
<span class="n">xfit</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">dt</span><span class="p">),</span> <span class="nf">max</span><span class="p">(</span><span class="n">dt</span><span class="p">),</span> <span class="n">length.out</span><span class="o">=</span><span class="m">40</span><span class="p">)</span>
<span class="n">yfit</span> <span class="o">&lt;-</span> <span class="nf">dnorm</span><span class="p">(</span><span class="n">xfit</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="nf">mean</span><span class="p">(</span><span class="n">dt</span><span class="p">),</span> <span class="n">sd</span><span class="o">=</span><span class="nf">sd</span><span class="p">(</span><span class="n">dt</span><span class="p">))</span>
<span class="n">yfit</span> <span class="o">&lt;-</span> <span class="n">yfit</span><span class="o">*</span><span class="nf">diff</span><span class="p">(</span><span class="n">h.plot</span><span class="o">$</span><span class="n">mids</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">])</span><span class="o">*</span><span class="nf">length</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">xfit</span><span class="p">,</span> <span class="n">yfit</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="nf">box</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PlottingBasic_29_0.png" src="_images/PlottingBasic_29_0.png" />
</div>
</div>
<p>轴须图是一种一维的数据呈现，而上面的左图中的密度曲线是一种核密度估计。要比较核密度图，参考 sm 包的 sm.density.compare() 函数。如果只是要绘制，使用 density() 函数辅助即可：</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">plot</span><span class="p">(</span><span class="nf">density</span><span class="p">(</span><span class="n">dt</span><span class="p">),</span> <span class="n">main</span><span class="o">=</span><span class="s">&quot;Kernel Denisty&quot;</span><span class="p">)</span>
<span class="nf">polygon</span><span class="p">(</span><span class="nf">density</span><span class="p">(</span><span class="n">dt</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&quot;lightgreen&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>  <span class="c1"># 绘制多边形的函数</span>
<span class="c1"># 叠加正态曲线</span>
<span class="n">xfit</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">dt</span><span class="p">),</span> <span class="nf">max</span><span class="p">(</span><span class="n">dt</span><span class="p">),</span> <span class="n">length.out</span><span class="o">=</span><span class="m">40</span><span class="p">)</span>
<span class="n">yfit</span> <span class="o">&lt;-</span> <span class="nf">dnorm</span><span class="p">(</span><span class="n">xfit</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="nf">mean</span><span class="p">(</span><span class="n">dt</span><span class="p">),</span> <span class="n">sd</span><span class="o">=</span><span class="nf">sd</span><span class="p">(</span><span class="n">dt</span><span class="p">))</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">xfit</span><span class="p">,</span> <span class="n">yfit</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="nf">legend</span><span class="p">(</span><span class="s">&quot;topright&quot;</span><span class="p">,</span> <span class="n">lty</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="s">&quot;red&quot;</span><span class="p">),</span>
       <span class="n">legend</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Kernel Density&quot;</span><span class="p">,</span> <span class="s">&quot;Normality Curve&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PlottingBasic_31_0.png" src="_images/PlottingBasic_31_0.png" />
</div>
</div>
</section>
<section id="箱形图：boxplot()-及小提琴图">
<h3><span class="section-number">5.4.4. </span>箱形图：boxplot() 及小提琴图<a class="headerlink" href="#箱形图：boxplot()-及小提琴图" title="永久链接至标题"></a></h3>
<p>或者叫箱线图、盒须图。它描述了连续变量的五个特征参数：</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span> <span class="o">&lt;-</span> <span class="nf">boxplot</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">main</span><span class="o">=</span><span class="s">&quot;Box Plot&quot;</span><span class="p">)</span>
<span class="n">paras</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Min&quot;</span><span class="p">,</span> <span class="s">&quot;25 percentile&quot;</span><span class="p">,</span> <span class="s">&quot;Mean&quot;</span><span class="p">,</span> <span class="s">&quot;75 percentile&quot;</span><span class="p">,</span> <span class="s">&quot;Max&quot;</span><span class="p">)</span>
<span class="nf">text</span><span class="p">(</span><span class="m">1.25</span><span class="p">,</span> <span class="n">fig</span><span class="o">$</span><span class="n">stats</span><span class="p">,</span> <span class="n">paras</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="m">4</span><span class="p">)</span>
<span class="nf">text</span><span class="p">(</span><span class="m">0.9</span><span class="p">,</span> <span class="n">fig</span><span class="o">$</span><span class="n">out</span><span class="p">,</span> <span class="s">&quot;Abnormal Points&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PlottingBasic_33_0.png" src="_images/PlottingBasic_33_0.png" />
</div>
</div>
<p>如果是 dataframe 数据集中的类别型变量 A ，使用如下语句生成并列箱形图：</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">~</span><span class="n">A</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dataframe</span><span class="p">)</span>
</pre></div>
</div>
<p>如果将公式改写成 <code class="docutils literal notranslate"><span class="pre">y~A*B</span></code>，那么会将类别型变量 A 和 B 的各水平两两组合，再生成箱形图。</p>
<p>其他参数：</p>
<ul class="simple">
<li><p>varwidth=F/T：为 TRUE 时，箱形图的宽度与样本数的算术平方根成正比。</p></li>
<li><p>horizontal=F/T：为 TRUE 时，箱形图被横置。</p></li>
<li><p>notch=F/T：为 TRUE 时，箱形图在绘制时会显示“凹槽”。</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="kc">NA</span><span class="p">)</span>
<span class="n">df</span> <span class="o">&lt;-</span> <span class="n">df</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">x</span><span class="p">),]</span>
<span class="n">df</span><span class="o">$</span><span class="n">type</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="s">&quot;Smaller&quot;</span><span class="p">,</span> <span class="m">50</span><span class="p">),</span> <span class="nf">rep</span><span class="p">(</span><span class="s">&quot;Larger&quot;</span><span class="p">,</span><span class="m">50</span><span class="p">))</span>
<span class="nf">boxplot</span><span class="p">(</span><span class="n">x</span> <span class="o">~</span> <span class="n">type</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&quot;darkgray&quot;</span><span class="p">,</span> <span class="n">main</span><span class="o">=</span><span class="s">&quot;Boxplot&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PlottingBasic_35_0.png" src="_images/PlottingBasic_35_0.png" />
</div>
</div>
<p>最后再提一下箱形图与核密度图的一个结合体：小提琴图（violin plot）。这种图的绘制需要 vioplot 包。</p>
<p>在小提琴图中，核密度曲线被竖直放置，并对称地显示于数据轴的两侧：</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># 需要加载：library(vioplot)</span>
<span class="nf">vioplot</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">x</span><span class="p">[</span><span class="n">df</span><span class="o">$</span><span class="n">type</span> <span class="o">==</span> <span class="s">&quot;Larger&quot;</span><span class="p">],</span> <span class="n">df</span><span class="o">$</span><span class="n">x</span><span class="p">[</span><span class="n">df</span><span class="o">$</span><span class="n">type</span> <span class="o">==</span> <span class="s">&quot;Smaller&quot;</span><span class="p">],</span>
        <span class="n">names</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;L&quot;</span><span class="p">,</span> <span class="s">&quot;S&quot;</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s">&quot;gold&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PlottingBasic_37_0.png" src="_images/PlottingBasic_37_0.png" />
</div>
</div>
</section>
<section id="点图">
<h3><span class="section-number">5.4.5. </span>点图<a class="headerlink" href="#点图" title="永久链接至标题"></a></h3>
<p>用于在水平刻度上绘制大量标签。本例选自参考书目同名章节。各参数：</p>
<ul class="simple">
<li><p>groups：选定一个因子，作为分组依据。</p></li>
<li><p>gcolor：各组标签的颜色。</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># mtcars 是 R 预装的数据集，其 cyl 变量有三个水平</span>
<span class="n">x</span> <span class="o">&lt;-</span> <span class="n">mtcars</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">),]</span>
<span class="n">x</span><span class="o">$</span><span class="n">cyl</span> <span class="o">&lt;-</span> <span class="nf">factor</span><span class="p">(</span><span class="n">x</span><span class="o">$</span><span class="n">cyl</span><span class="p">)</span>
<span class="n">x</span><span class="o">$</span><span class="n">color</span><span class="p">[</span><span class="n">x</span><span class="o">$</span><span class="n">cyl</span><span class="o">==</span><span class="m">4</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="s">&quot;red&quot;</span>
<span class="n">x</span><span class="o">$</span><span class="n">color</span><span class="p">[</span><span class="n">x</span><span class="o">$</span><span class="n">cyl</span><span class="o">==</span><span class="m">6</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="s">&quot;blue&quot;</span>
<span class="n">x</span><span class="o">$</span><span class="n">color</span><span class="p">[</span><span class="n">x</span><span class="o">$</span><span class="n">cyl</span><span class="o">==</span><span class="m">8</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="s">&quot;darkgreen&quot;</span>
<span class="nf">dotchart</span><span class="p">(</span><span class="n">x</span><span class="o">$</span><span class="n">mpg</span><span class="p">,</span>
         <span class="n">labels</span> <span class="o">=</span> <span class="nf">row.names</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
         <span class="n">cex</span><span class="o">=</span><span class="n">.</span><span class="m">7</span><span class="p">,</span>
         <span class="n">groups</span> <span class="o">=</span> <span class="n">x</span><span class="o">$</span><span class="n">cyl</span><span class="p">,</span>
         <span class="n">gcolor</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">,</span>
         <span class="n">color</span> <span class="o">=</span> <span class="n">x</span><span class="o">$</span><span class="n">color</span><span class="p">,</span>
         <span class="n">pch</span><span class="o">=</span><span class="m">19</span><span class="p">,</span>
         <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;Gas Mileage for Car Models\ngrouped by cylinder&quot;</span><span class="p">,</span>
         <span class="n">xlab</span> <span class="o">=</span> <span class="s">&quot;Miles Per Gallon&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/PlottingBasic_39_0.png" src="_images/PlottingBasic_39_0.png" />
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="CreateFunctions.html" class="btn btn-neutral float-left" title="4. 函数操作" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="PlottingGGplot2.html" class="btn btn-neutral float-right" title="6. ggplot2 绘图" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 wklchris.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a>开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 

<div class="footer">本页面采用 <a href="https://analytics.google.com/">Google Analytics</a> 来记录访问数据. 您可以通过屏蔽来自 www.google-analytics.com 的 JavaScript 来阻止该记录行为.
<script>
  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ?
              'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>
</div>



</body>
</html>